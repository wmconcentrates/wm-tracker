<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>White Mousse Blog - Serving the Terps</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Behind the scenes at White Mousse Concentrates. Strain spotlights, extraction insights, and the latest drops from Colorado's premier concentrate producer.">
    <meta name="keywords" content="cannabis concentrates, live resin, terpenes, Colorado cannabis, wholesale concentrates, extraction, shatter, wax, budder">
    <meta name="author" content="White Mousse Concentrates">
    <meta name="robots" content="index, follow">

    <!-- Open Graph / Social -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="White Mousse Blog - Serving the Terps">
    <meta property="og:description" content="Behind the scenes at White Mousse Concentrates. Strain spotlights, extraction insights, and the latest drops.">
    <meta property="og:url" content="https://blog.whitemousse.com">
    <meta property="og:site_name" content="White Mousse Concentrates">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="White Mousse Blog">
    <meta name="twitter:description" content="Behind the scenes at White Mousse Concentrates.">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://blog.whitemousse.com">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Work+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <style>
        :root {
            /* Electric Forest - Laser show vibes */
            --bg-primary: #000000;
            --bg-secondary: #0a0a0a;
            --bg-tertiary: #141414;
            --bg-card: #0d0d0d;
            --accent-purple: #bf00ff;
            --accent-green: #39ff14;
            --accent-blue: #00f0ff;
            --accent-orange: #ff6b00;
            --accent-red: #ff0055;
            --accent-pink: #ff10f0;
            --accent-yellow: #ffff00;
            --text-primary: #ffffff;
            --text-secondary: #888888;
            --text-muted: #555555;
            --border: #222222;
            --glow-green: 0 0 20px rgba(57, 255, 20, 0.5);
            --glow-pink: 0 0 20px rgba(255, 16, 240, 0.5);
            --glow-blue: 0 0 20px rgba(0, 240, 255, 0.5);
            --glow-purple: 0 0 20px rgba(191, 0, 255, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Work Sans', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--accent-pink), var(--accent-purple), var(--accent-blue));
            padding: 20px 40px;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 0 40px rgba(255, 16, 240, 0.4), 0 0 80px rgba(0, 240, 255, 0.2);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-family: 'Space Mono', monospace;
            font-size: 1.8rem;
            font-weight: 700;
            text-decoration: none;
            color: white;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        .logo span {
            font-size: 0.9rem;
            opacity: 0.9;
            display: block;
            font-weight: 400;
            letter-spacing: 3px;
        }

        .nav {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .nav a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            padding: 8px 16px;
            border-radius: 8px;
        }

        .nav a:hover {
            background: rgba(255, 255, 255, 0.2);
            text-shadow: 0 0 10px white;
        }

        .admin-btn {
            background: rgba(0, 0, 0, 0.3) !important;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        /* Hero Section */
        .hero {
            padding: 80px 40px;
            text-align: center;
            background: radial-gradient(ellipse at top, var(--bg-tertiary) 0%, var(--bg-primary) 70%);
            border-bottom: 1px solid var(--border);
        }

        .hero h1 {
            font-family: 'Space Mono', monospace;
            font-size: 3rem;
            margin-bottom: 20px;
            background: linear-gradient(90deg, var(--accent-green), var(--accent-blue), var(--accent-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 60px rgba(57, 255, 20, 0.3);
        }

        .hero p {
            font-size: 1.3rem;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto;
        }

        /* Main Content */
        .main {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px;
        }

        /* Categories */
        .categories {
            display: flex;
            gap: 15px;
            margin-bottom: 40px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .category-btn {
            padding: 12px 24px;
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 30px;
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .category-btn:hover, .category-btn.active {
            border-color: var(--accent-green);
            box-shadow: var(--glow-green);
            color: var(--accent-green);
        }

        .category-btn[data-category="drops"] { --cat-color: var(--accent-pink); }
        .category-btn[data-category="drops"]:hover, .category-btn[data-category="drops"].active {
            border-color: var(--accent-pink);
            box-shadow: var(--glow-pink);
            color: var(--accent-pink);
        }

        .category-btn[data-category="strains"] { --cat-color: var(--accent-purple); }
        .category-btn[data-category="strains"]:hover, .category-btn[data-category="strains"].active {
            border-color: var(--accent-purple);
            box-shadow: var(--glow-purple);
            color: var(--accent-purple);
        }

        .category-btn[data-category="education"] { --cat-color: var(--accent-blue); }
        .category-btn[data-category="education"]:hover, .category-btn[data-category="education"].active {
            border-color: var(--accent-blue);
            box-shadow: var(--glow-blue);
            color: var(--accent-blue);
        }

        /* Blog Grid */
        .blog-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
        }

        .blog-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s;
            cursor: pointer;
        }

        .blog-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-purple);
            box-shadow: 0 10px 40px rgba(191, 0, 255, 0.2);
        }

        .blog-card-image {
            height: 200px;
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            position: relative;
            overflow: hidden;
        }

        .blog-card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .blog-card-category {
            position: absolute;
            top: 15px;
            left: 15px;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .blog-card-category.drops { background: var(--accent-pink); }
        .blog-card-category.strains { background: var(--accent-purple); }
        .blog-card-category.education { background: var(--accent-blue); }
        .blog-card-category.behind-scenes { background: var(--accent-orange); }
        .blog-card-category.news { background: var(--accent-green); color: black; }

        .blog-card-content {
            padding: 25px;
        }

        .blog-card-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 10px;
            line-height: 1.3;
        }

        .blog-card-excerpt {
            color: var(--text-secondary);
            font-size: 0.95rem;
            margin-bottom: 15px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .blog-card-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .blog-card-author {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .author-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--accent-purple);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
        }

        /* Featured Post */
        .featured-post {
            background: var(--bg-card);
            border: 2px solid var(--accent-green);
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 50px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            box-shadow: var(--glow-green);
        }

        .featured-post-image {
            min-height: 400px;
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 6rem;
        }

        .featured-post-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .featured-post-content {
            padding: 50px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .featured-label {
            color: var(--accent-green);
            font-weight: 700;
            font-size: 0.85rem;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 15px;
            text-shadow: var(--glow-green);
        }

        .featured-post-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 20px;
            line-height: 1.2;
        }

        .featured-post-excerpt {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-bottom: 25px;
            line-height: 1.7;
        }

        .read-more-btn {
            display: inline-block;
            padding: 14px 30px;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            border: none;
            border-radius: 10px;
            color: black;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            align-self: flex-start;
        }

        .read-more-btn:hover {
            transform: scale(1.05);
            box-shadow: var(--glow-green);
        }

        /* Single Post View */
        .single-post {
            display: none;
            max-width: 900px;
            margin: 0 auto;
        }

        .single-post.active {
            display: block;
        }

        .single-post-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .single-post-category {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 20px;
        }

        .single-post-title {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 20px;
            line-height: 1.2;
        }

        .single-post-meta {
            color: var(--text-secondary);
            display: flex;
            gap: 30px;
            justify-content: center;
            align-items: center;
        }

        .single-post-image {
            width: 100%;
            height: 400px;
            background: var(--bg-secondary);
            border-radius: 16px;
            margin-bottom: 40px;
            overflow: hidden;
        }

        .single-post-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .single-post-body {
            font-size: 1.15rem;
            line-height: 1.8;
            color: var(--text-primary);
        }

        .single-post-body p {
            margin-bottom: 20px;
        }

        .single-post-body h2 {
            color: var(--accent-green);
            margin: 40px 0 20px;
            font-size: 1.8rem;
        }

        .single-post-body h3 {
            color: var(--accent-blue);
            margin: 30px 0 15px;
            font-size: 1.4rem;
        }

        .single-post-body ul, .single-post-body ol {
            margin: 20px 0;
            padding-left: 30px;
        }

        .single-post-body li {
            margin-bottom: 10px;
        }

        .single-post-body blockquote {
            border-left: 4px solid var(--accent-purple);
            padding-left: 20px;
            margin: 30px 0;
            font-style: italic;
            color: var(--text-secondary);
        }

        /* Batch Data Card */
        .batch-data-card {
            background: var(--bg-secondary);
            border: 2px solid var(--accent-purple);
            border-radius: 16px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: var(--glow-purple);
        }

        .batch-data-title {
            font-family: 'Space Mono', monospace;
            color: var(--accent-purple);
            font-size: 1rem;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .batch-data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
        }

        .batch-stat {
            text-align: center;
        }

        .batch-stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--accent-green);
            text-shadow: var(--glow-green);
        }

        .batch-stat-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        /* Admin Panel */
        .admin-panel {
            display: none;
            background: var(--bg-secondary);
            padding: 40px;
            border-radius: 20px;
            border: 2px solid var(--border);
        }

        .admin-panel.active {
            display: block;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .admin-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--accent-pink);
        }

        .admin-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--border);
            padding-bottom: 15px;
        }

        .admin-tab {
            padding: 10px 20px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 8px;
        }

        .admin-tab:hover, .admin-tab.active {
            color: var(--accent-green);
            background: rgba(57, 255, 20, 0.1);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 1px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 14px;
            background: var(--bg-tertiary);
            border: 2px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 1rem;
            font-family: 'Work Sans', sans-serif;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--accent-purple);
            box-shadow: 0 0 20px rgba(191, 0, 255, 0.2);
        }

        .form-group textarea {
            min-height: 200px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-pink), var(--accent-purple));
            color: white;
            box-shadow: var(--glow-pink);
        }

        .btn-primary:hover {
            transform: scale(1.05);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            border: 2px solid var(--border);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            border-color: var(--accent-blue);
        }

        /* Batch Drafts */
        .batch-drafts {
            display: grid;
            gap: 15px;
        }

        .batch-draft-card {
            background: var(--bg-tertiary);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .batch-draft-card:hover {
            border-color: var(--accent-green);
        }

        .batch-draft-info h4 {
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .batch-draft-info p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .batch-draft-actions {
            display: flex;
            gap: 10px;
        }

        /* Login Modal */
        .login-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }

        .login-modal.active {
            display: flex;
        }

        .login-box {
            background: var(--bg-secondary);
            padding: 40px;
            border-radius: 20px;
            border: 2px solid var(--accent-purple);
            box-shadow: var(--glow-purple);
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .login-box h2 {
            margin-bottom: 30px;
            color: var(--accent-purple);
        }

        .login-box input {
            width: 100%;
            padding: 15px;
            margin-bottom: 20px;
            background: var(--bg-tertiary);
            border: 2px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 1.2rem;
            text-align: center;
            letter-spacing: 8px;
        }

        /* Back Button */
        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            margin-bottom: 30px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .back-btn:hover {
            color: var(--accent-green);
        }

        /* Footer */
        .footer {
            background: var(--bg-secondary);
            padding: 40px;
            text-align: center;
            border-top: 1px solid var(--border);
            margin-top: 80px;
        }

        .footer-links {
            display: flex;
            gap: 30px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: var(--accent-green);
        }

        .footer-copy {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 60px;
            color: var(--text-secondary);
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid var(--border);
            border-top-color: var(--accent-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 900px) {
            .featured-post {
                grid-template-columns: 1fr;
            }

            .featured-post-image {
                min-height: 250px;
            }

            .featured-post-content {
                padding: 30px;
            }

            .single-post-title {
                font-size: 2rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 600px) {
            .header {
                padding: 15px 20px;
            }

            .header-content {
                flex-direction: column;
                gap: 15px;
            }

            .nav {
                gap: 15px;
            }

            .hero {
                padding: 50px 20px;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .main {
                padding: 20px;
            }

            .blog-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo" onclick="showBlogList()">
                WM
                <span>SERVE THE TERPS</span>
            </a>
            <nav class="nav">
                <a href="https://whitemousse.com">Main Site</a>
                <a href="#" onclick="showBlogList()">Blog</a>
                <a href="#" class="admin-btn" onclick="showAdminLogin()">Staff Portal</a>
            </nav>
        </div>
    </header>

    <!-- Hero (Blog List View) -->
    <section class="hero" id="heroSection">
        <h1>BEHIND THE TERPS</h1>
        <p>Strain spotlights, lab insights, and the freshest drops from Colorado's premier concentrate producer.</p>
    </section>

    <!-- Main Content -->
    <main class="main">
        <!-- Blog List View -->
        <div id="blogListView">
            <!-- Categories -->
            <div class="categories">
                <button class="category-btn active" data-category="all" onclick="filterPosts('all')">All Posts</button>
                <button class="category-btn" data-category="drops" onclick="filterPosts('drops')">New Drops</button>
                <button class="category-btn" data-category="strains" onclick="filterPosts('strains')">Strain Spotlight</button>
                <button class="category-btn" data-category="education" onclick="filterPosts('education')">Education</button>
                <button class="category-btn" data-category="behind-scenes" onclick="filterPosts('behind-scenes')">Behind the Scenes</button>
            </div>

            <!-- Featured Post -->
            <div id="featuredPost" class="featured-post" style="display: none;"></div>

            <!-- Blog Grid -->
            <div id="blogGrid" class="blog-grid">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>Loading posts...</p>
                </div>
            </div>
        </div>

        <!-- Single Post View -->
        <article class="single-post" id="singlePostView"></article>

        <!-- Admin Panel -->
        <div class="admin-panel" id="adminPanel">
            <div class="admin-header">
                <h2 class="admin-title">Content Hub</h2>
                <button class="btn btn-secondary" onclick="showBlogList()">‚Üê Back to Blog</button>
            </div>

            <div class="admin-tabs">
                <button class="admin-tab active" onclick="showAdminTab('write')">Write Post</button>
                <button class="admin-tab" onclick="showAdminTab('drafts')">Batch Drafts</button>
                <button class="admin-tab" onclick="showAdminTab('manage')">Manage Posts</button>
            </div>

            <!-- Write Post Tab -->
            <div id="writeTab" class="admin-tab-content">
                <form id="postForm" onsubmit="submitPost(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Category</label>
                            <select id="postCategory" required>
                                <option value="">Select category...</option>
                                <option value="drops">New Drop</option>
                                <option value="strains">Strain Spotlight</option>
                                <option value="education">Education</option>
                                <option value="behind-scenes">Behind the Scenes</option>
                                <option value="news">Industry News</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Author</label>
                            <input type="text" id="postAuthor" placeholder="Your name" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Title</label>
                        <input type="text" id="postTitle" placeholder="Enter a catchy title..." required>
                    </div>

                    <div class="form-group">
                        <label>Excerpt (Short Preview)</label>
                        <input type="text" id="postExcerpt" placeholder="Brief description for the blog grid..." required>
                    </div>

                    <div class="form-group">
                        <label>Content</label>
                        <textarea id="postContent" placeholder="Write your post here... Use markdown for formatting!"></textarea>
                    </div>

                    <div class="form-group">
                        <label>Link to Batch (Optional)</label>
                        <select id="postBatch">
                            <option value="">No batch linked</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Emoji Icon</label>
                        <input type="text" id="postEmoji" placeholder="üî•" maxlength="2" style="width: 80px; text-align: center; font-size: 1.5rem;">
                    </div>

                    <div style="display: flex; gap: 15px;">
                        <button type="submit" class="btn btn-primary">Publish Post</button>
                        <button type="button" class="btn btn-secondary" onclick="saveDraft()">Save as Draft</button>
                    </div>
                </form>
            </div>

            <!-- Batch Drafts Tab -->
            <div id="draftsTab" class="admin-tab-content" style="display: none;">
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    These are auto-generated drafts from completed batches. Edit and publish them!
                </p>
                <div id="batchDrafts" class="batch-drafts">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <p>Loading batch data...</p>
                    </div>
                </div>
            </div>

            <!-- Manage Posts Tab -->
            <div id="manageTab" class="admin-tab-content" style="display: none;">
                <div id="managePosts" class="batch-drafts">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <p>Loading posts...</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Login Modal -->
    <div class="login-modal" id="loginModal">
        <div class="login-box">
            <h2>Staff Login</h2>
            <p style="color: var(--text-secondary); margin-bottom: 20px;">Enter your PIN to access the Content Hub</p>
            <input type="password" id="adminPin" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="4" pattern="[0-9]*" inputmode="numeric">
            <button class="btn btn-primary" style="width: 100%;" onclick="adminLogin()">Enter</button>
            <button class="btn btn-secondary" style="width: 100%; margin-top: 10px;" onclick="closeLoginModal()">Cancel</button>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-links">
            <a href="https://whitemousse.com">Home</a>
            <a href="https://whitemousse.com/stores">Find Us</a>
            <a href="https://whitemousse.com/wholesale">Wholesale</a>
            <a href="https://instagram.com/white.mousse.concentrates">Instagram</a>
        </div>
        <p class="footer-copy">&copy; 2024 White Mousse Concentrates. All rights reserved.</p>
    </footer>

    <script>
        // Supabase config - same as production tracker
        const SUPABASE_URL = 'https://rcbwjpfacuamwxqtwhmv.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJjYndqcGZhY3VhbXd4cXR3aG12Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU5NDA4ODAsImV4cCI6MjA2MTUxNjg4MH0.eAPPS2PzVERVXO7c8hdeSeyxLOOKCzlbJg1Nm95L6-E';

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        let currentView = 'list';
        let allPosts = [];
        let currentCategory = 'all';
        let isLoggedIn = false;
        let currentUser = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            await loadPosts();
            setupRealtimeSubscription();
        });

        // Load all posts
        async function loadPosts() {
            try {
                const { data, error } = await supabase
                    .from('wm_blog_posts')
                    .select('*')
                    .eq('status', 'published')
                    .order('created_at', { ascending: false });

                if (error) throw error;

                allPosts = data || [];
                renderPosts();
            } catch (error) {
                console.error('Error loading posts:', error);
                // Show sample posts if no database table yet
                showSamplePosts();
            }
        }

        // Show sample posts for demo
        function showSamplePosts() {
            allPosts = [
                {
                    id: 1,
                    title: "Fresh Drop: GMO Cookies Live Resin",
                    excerpt: "Our latest batch of GMO Cookies is hitting dispensary shelves this week. Expect heavy garlic and diesel notes with a potent indica effect.",
                    content: "We're excited to announce our newest drop...",
                    category: "drops",
                    author: "WM Team",
                    emoji: "üî•",
                    created_at: new Date().toISOString(),
                    batch_id: null
                },
                {
                    id: 2,
                    title: "Strain Spotlight: Tropicana Cookies",
                    excerpt: "Breaking down the terpene profile of one of our most requested strains. Learn why this citrus-forward cultivar is a customer favorite.",
                    content: "Tropicana Cookies has quickly become...",
                    category: "strains",
                    author: "Lab Team",
                    emoji: "üçä",
                    created_at: new Date(Date.now() - 86400000).toISOString(),
                    batch_id: null
                },
                {
                    id: 3,
                    title: "What Makes Live Resin Different?",
                    excerpt: "A deep dive into the extraction process that preserves the full spectrum of cannabinoids and terpenes from fresh-frozen cannabis.",
                    content: "Live resin represents a significant advancement...",
                    category: "education",
                    author: "WM Team",
                    emoji: "üß™",
                    created_at: new Date(Date.now() - 172800000).toISOString(),
                    batch_id: null
                },
                {
                    id: 4,
                    title: "A Day in the Lab",
                    excerpt: "Go behind the scenes with our extraction team. See how we turn premium flower into the concentrates you love.",
                    content: "Every batch starts with careful selection...",
                    category: "behind-scenes",
                    author: "Marcus",
                    emoji: "üë®‚Äçüî¨",
                    created_at: new Date(Date.now() - 259200000).toISOString(),
                    batch_id: null
                }
            ];
            renderPosts();
        }

        // Render posts to grid
        function renderPosts() {
            const grid = document.getElementById('blogGrid');
            const featuredContainer = document.getElementById('featuredPost');

            const filtered = currentCategory === 'all'
                ? allPosts
                : allPosts.filter(p => p.category === currentCategory);

            if (filtered.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="empty-state-icon">üìù</div>
                        <h3>No posts yet</h3>
                        <p>Check back soon for fresh content!</p>
                    </div>
                `;
                featuredContainer.style.display = 'none';
                return;
            }

            // Featured post (first one)
            const featured = filtered[0];
            featuredContainer.style.display = 'grid';
            featuredContainer.innerHTML = `
                <div class="featured-post-image">
                    ${featured.image_url
                        ? `<img src="${featured.image_url}" alt="${featured.title}">`
                        : featured.emoji || 'üî•'}
                </div>
                <div class="featured-post-content">
                    <div class="featured-label">‚ú® Latest Post</div>
                    <h2 class="featured-post-title">${featured.title}</h2>
                    <p class="featured-post-excerpt">${featured.excerpt}</p>
                    <a href="#" class="read-more-btn" onclick="showPost(${featured.id}); return false;">Read More ‚Üí</a>
                </div>
            `;

            // Rest of posts
            const rest = filtered.slice(1);
            if (rest.length === 0) {
                grid.innerHTML = '';
                return;
            }

            grid.innerHTML = rest.map(post => `
                <article class="blog-card" onclick="showPost(${post.id})">
                    <div class="blog-card-image">
                        ${post.image_url
                            ? `<img src="${post.image_url}" alt="${post.title}">`
                            : post.emoji || 'üìù'}
                        <span class="blog-card-category ${post.category}">${formatCategory(post.category)}</span>
                    </div>
                    <div class="blog-card-content">
                        <h3 class="blog-card-title">${post.title}</h3>
                        <p class="blog-card-excerpt">${post.excerpt}</p>
                        <div class="blog-card-meta">
                            <div class="blog-card-author">
                                <div class="author-avatar">${(post.author || 'WM')[0]}</div>
                                <span>${post.author || 'WM Team'}</span>
                            </div>
                            <span>${formatDate(post.created_at)}</span>
                        </div>
                    </div>
                </article>
            `).join('');
        }

        // Filter posts by category
        function filterPosts(category) {
            currentCategory = category;

            // Update active button
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.category === category);
            });

            renderPosts();
        }

        // Show single post
        async function showPost(postId) {
            const post = allPosts.find(p => p.id === postId);
            if (!post) return;

            document.getElementById('blogListView').style.display = 'none';
            document.getElementById('heroSection').style.display = 'none';
            document.getElementById('adminPanel').classList.remove('active');

            const postView = document.getElementById('singlePostView');
            postView.classList.add('active');

            // Load batch data if linked
            let batchHtml = '';
            if (post.batch_id) {
                try {
                    const { data: batch } = await supabase
                        .from('wm_batches')
                        .select('*')
                        .eq('id', post.batch_id)
                        .single();

                    if (batch) {
                        batchHtml = `
                            <div class="batch-data-card">
                                <div class="batch-data-title">üìä Batch Data</div>
                                <div class="batch-data-grid">
                                    <div class="batch-stat">
                                        <div class="batch-stat-value">${batch.strain || 'N/A'}</div>
                                        <div class="batch-stat-label">Strain</div>
                                    </div>
                                    <div class="batch-stat">
                                        <div class="batch-stat-value">${batch.starting_weight || 'N/A'}g</div>
                                        <div class="batch-stat-label">Input</div>
                                    </div>
                                    <div class="batch-stat">
                                        <div class="batch-stat-value">${batch.final_yield || 'N/A'}g</div>
                                        <div class="batch-stat-label">Yield</div>
                                    </div>
                                    <div class="batch-stat">
                                        <div class="batch-stat-value">${batch.yield_percentage || 'N/A'}%</div>
                                        <div class="batch-stat-label">Efficiency</div>
                                    </div>
                                </div>
                            </div>
                        `;
                    }
                } catch (e) {
                    console.error('Error loading batch:', e);
                }
            }

            postView.innerHTML = `
                <a href="#" class="back-btn" onclick="showBlogList(); return false;">‚Üê Back to all posts</a>
                <header class="single-post-header">
                    <span class="single-post-category ${post.category}" style="background: var(--accent-purple);">
                        ${formatCategory(post.category)}
                    </span>
                    <h1 class="single-post-title">${post.title}</h1>
                    <div class="single-post-meta">
                        <span>By ${post.author || 'WM Team'}</span>
                        <span>‚Ä¢</span>
                        <span>${formatDate(post.created_at)}</span>
                    </div>
                </header>
                ${post.image_url ? `
                    <div class="single-post-image">
                        <img src="${post.image_url}" alt="${post.title}">
                    </div>
                ` : ''}
                ${batchHtml}
                <div class="single-post-body">
                    ${formatContent(post.content)}
                </div>
            `;

            // Update URL
            history.pushState({ postId }, post.title, `?post=${postId}`);
            window.scrollTo(0, 0);
        }

        // Show blog list
        function showBlogList() {
            document.getElementById('blogListView').style.display = 'block';
            document.getElementById('heroSection').style.display = 'block';
            document.getElementById('singlePostView').classList.remove('active');
            document.getElementById('adminPanel').classList.remove('active');
            history.pushState({}, 'Blog', '?');
        }

        // Admin login
        function showAdminLogin() {
            document.getElementById('loginModal').classList.add('active');
            document.getElementById('adminPin').focus();
        }

        function closeLoginModal() {
            document.getElementById('loginModal').classList.remove('active');
            document.getElementById('adminPin').value = '';
        }

        async function adminLogin() {
            const pin = document.getElementById('adminPin').value;

            // Use same PIN system as tracker
            const validPins = ['1111', '2222', '3333', '4444', '5555', '6666'];

            if (validPins.includes(pin)) {
                isLoggedIn = true;
                closeLoginModal();
                showAdminPanel();
            } else {
                alert('Invalid PIN');
            }
        }

        // Show admin panel
        async function showAdminPanel() {
            document.getElementById('blogListView').style.display = 'none';
            document.getElementById('heroSection').style.display = 'none';
            document.getElementById('singlePostView').classList.remove('active');
            document.getElementById('adminPanel').classList.add('active');

            await loadBatchDrafts();
            await loadManagePosts();
        }

        // Load batch drafts from completed batches
        async function loadBatchDrafts() {
            const container = document.getElementById('batchDrafts');

            try {
                // Get recent completed batches
                const { data: batches, error } = await supabase
                    .from('wm_batches')
                    .select('*')
                    .eq('status', 'complete')
                    .order('updated_at', { ascending: false })
                    .limit(10);

                if (error) throw error;

                if (!batches || batches.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">üì¶</div>
                            <p>No completed batches found. Complete a batch in the tracker to auto-generate drafts!</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = batches.map(batch => `
                    <div class="batch-draft-card">
                        <div class="batch-draft-info">
                            <h4>${batch.strain || 'Unknown Strain'} - ${batch.batch_id}</h4>
                            <p>Completed ${formatDate(batch.updated_at)} ‚Ä¢ ${batch.final_yield || '?'}g yield</p>
                        </div>
                        <div class="batch-draft-actions">
                            <button class="btn btn-primary" onclick="generatePostFromBatch('${batch.id}')">
                                Generate Post
                            </button>
                        </div>
                    </div>
                `).join('');

            } catch (error) {
                console.error('Error loading batches:', error);
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">‚ö†Ô∏è</div>
                        <p>Could not load batches. Make sure the database is connected.</p>
                    </div>
                `;
            }
        }

        // Generate post from batch data
        async function generatePostFromBatch(batchId) {
            try {
                const { data: batch, error } = await supabase
                    .from('wm_batches')
                    .select('*')
                    .eq('id', batchId)
                    .single();

                if (error) throw error;

                // Auto-fill the form
                document.getElementById('postCategory').value = 'drops';
                document.getElementById('postTitle').value = `Fresh Drop: ${batch.strain || 'New Strain'}`;
                document.getElementById('postExcerpt').value = `Just finished processing ${batch.starting_weight}g of ${batch.strain}. This batch yielded ${batch.final_yield}g of premium concentrate.`;
                document.getElementById('postContent').value = `## ${batch.strain} - Batch ${batch.batch_id}

We're excited to announce our latest batch is complete and heading to dispensary shelves!

### Batch Details
- **Strain:** ${batch.strain}
- **Input Material:** ${batch.starting_weight}g
- **Final Yield:** ${batch.final_yield}g
- **Yield Percentage:** ${batch.yield_percentage || 'N/A'}%
- **Product Type:** ${batch.planned_products || 'Concentrate'}

### Notes
${batch.notes || 'This batch showcases the full terpene profile we strive for in every run.'}

Look for this drop at your favorite dispensary soon!
`;
                document.getElementById('postEmoji').value = 'üî•';

                // Switch to write tab
                showAdminTab('write');

            } catch (error) {
                console.error('Error generating post:', error);
                alert('Error loading batch data');
            }
        }

        // Load manage posts
        async function loadManagePosts() {
            const container = document.getElementById('managePosts');

            try {
                const { data: posts, error } = await supabase
                    .from('wm_blog_posts')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) throw error;

                if (!posts || posts.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">üìù</div>
                            <p>No posts yet. Write your first post!</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = posts.map(post => `
                    <div class="batch-draft-card">
                        <div class="batch-draft-info">
                            <h4>${post.title}</h4>
                            <p>${formatCategory(post.category)} ‚Ä¢ ${post.status} ‚Ä¢ ${formatDate(post.created_at)}</p>
                        </div>
                        <div class="batch-draft-actions">
                            <button class="btn btn-secondary" onclick="editPost('${post.id}')">Edit</button>
                            <button class="btn btn-secondary" onclick="deletePost('${post.id}')" style="color: var(--accent-red);">Delete</button>
                        </div>
                    </div>
                `).join('');

            } catch (error) {
                console.error('Error loading posts:', error);
                container.innerHTML = `
                    <div class="empty-state">
                        <p>Could not load posts.</p>
                    </div>
                `;
            }
        }

        // Submit post
        async function submitPost(e) {
            e.preventDefault();

            const post = {
                title: document.getElementById('postTitle').value,
                excerpt: document.getElementById('postExcerpt').value,
                content: document.getElementById('postContent').value,
                category: document.getElementById('postCategory').value,
                author: document.getElementById('postAuthor').value,
                emoji: document.getElementById('postEmoji').value || 'üìù',
                status: 'published',
                created_at: new Date().toISOString()
            };

            try {
                const { data, error } = await supabase
                    .from('wm_blog_posts')
                    .insert([post])
                    .select();

                if (error) throw error;

                alert('Post published!');
                document.getElementById('postForm').reset();
                await loadPosts();
                await loadManagePosts();

            } catch (error) {
                console.error('Error publishing:', error);
                alert('Error publishing post. Make sure the blog_posts table exists.');
            }
        }

        // Delete post
        async function deletePost(postId) {
            if (!confirm('Are you sure you want to delete this post?')) return;

            try {
                const { error } = await supabase
                    .from('wm_blog_posts')
                    .delete()
                    .eq('id', postId);

                if (error) throw error;

                await loadPosts();
                await loadManagePosts();

            } catch (error) {
                console.error('Error deleting:', error);
                alert('Error deleting post');
            }
        }

        // Admin tabs
        function showAdminTab(tabName) {
            document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.admin-tab-content').forEach(c => c.style.display = 'none');

            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').style.display = 'block';
        }

        // Realtime subscription
        function setupRealtimeSubscription() {
            supabase
                .channel('blog-changes')
                .on('postgres_changes', { event: '*', schema: 'public', table: 'wm_blog_posts' }, () => {
                    loadPosts();
                })
                .subscribe();
        }

        // Utility functions
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }

        function formatCategory(cat) {
            const names = {
                'drops': 'New Drop',
                'strains': 'Strain Spotlight',
                'education': 'Education',
                'behind-scenes': 'Behind the Scenes',
                'news': 'Industry News'
            };
            return names[cat] || cat;
        }

        function formatContent(content) {
            if (!content) return '';

            // Simple markdown-like formatting
            return content
                .split('\n\n').map(p => {
                    if (p.startsWith('## ')) {
                        return `<h2>${p.slice(3)}</h2>`;
                    } else if (p.startsWith('### ')) {
                        return `<h3>${p.slice(4)}</h3>`;
                    } else if (p.startsWith('- ')) {
                        const items = p.split('\n').map(i => `<li>${i.slice(2)}</li>`).join('');
                        return `<ul>${items}</ul>`;
                    } else if (p.startsWith('> ')) {
                        return `<blockquote>${p.slice(2)}</blockquote>`;
                    } else {
                        return `<p>${p}</p>`;
                    }
                })
                .join('');
        }

        // Handle browser back button
        window.addEventListener('popstate', (e) => {
            if (e.state && e.state.postId) {
                showPost(e.state.postId);
            } else {
                showBlogList();
            }
        });

        // Handle Enter key in PIN input
        document.getElementById('adminPin').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') adminLogin();
        });
    </script>

    <!-- Schema.org structured data for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Blog",
        "name": "White Mousse Blog",
        "description": "Behind the scenes at White Mousse Concentrates. Strain spotlights, extraction insights, and the latest drops.",
        "url": "https://blog.whitemousse.com",
        "publisher": {
            "@type": "Organization",
            "name": "White Mousse Concentrates",
            "url": "https://whitemousse.com"
        }
    }
    </script>
</body>
</html>
